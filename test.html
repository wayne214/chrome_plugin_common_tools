<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chromeæ’ä»¶æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .test-btn {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            background: #007cff;
            color: white;
            cursor: pointer;
        }
        .test-btn:hover {
            background: #0056b3;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            background: #fff;
            border-radius: 4px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <h1>ğŸ”§ Chromeæ’ä»¶æµ‹è¯•é¡µé¢</h1>
    
    <div class="test-section">
        <h2>æ’ä»¶åŠŸèƒ½æµ‹è¯•</h2>
        <p>è¿™ä¸ªé¡µé¢ç”¨äºæµ‹è¯•Chromeæ’ä»¶çš„å„ç§åŠŸèƒ½</p>
        
        <button class="test-btn" onclick="testMessage()">æµ‹è¯•æ¶ˆæ¯ä¼ é€’</button>
        <button class="test-btn" onclick="testScreenshot()">æµ‹è¯•æ™®é€šæˆªå›¾</button>
        <button class="test-btn" onclick="testAreaScreenshot()">æµ‹è¯•åŒºåŸŸæˆªå›¾</button>
        <button class="test-btn" onclick="triggerAreaSelection()">è§¦å‘åŒºåŸŸé€‰æ‹©</button>
        
        <div id="result" class="result">
            <label for="test-output">æµ‹è¯•ç»“æœï¼š</label>
            <div id="test-output">æµ‹è¯•ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>æµ‹è¯•å†…å®¹åŒºåŸŸ</h2>
        <p>è¿™æ˜¯ä¸€äº›ç”¨äºæˆªå›¾æµ‹è¯•çš„å†…å®¹ã€‚ä½ å¯ä»¥é€‰æ‹©è¿™ä¸ªåŒºåŸŸè¿›è¡Œæˆªå›¾æµ‹è¯•ã€‚</p>
        <div style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4); padding: 30px; color: white; text-align: center; border-radius: 10px; margin: 20px 0;">
            <h3>ğŸ¨ å½©è‰²æµ‹è¯•åŒºåŸŸ</h3>
            <p>è¿™æ˜¯ä¸€ä¸ªå½©è‰²çš„æµ‹è¯•åŒºåŸŸï¼Œæ–¹ä¾¿éªŒè¯æˆªå›¾åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</p>
        </div>
        
        <div style="background: #2c3e50; color: white; padding: 20px; border-radius: 8px;">
            <h3>ğŸ“Š æ·±è‰²æµ‹è¯•åŒºåŸŸ</h3>
            <p>æ·±è‰²èƒŒæ™¯åŒºåŸŸï¼Œç”¨äºæµ‹è¯•ä¸åŒèƒŒæ™¯ä¸‹çš„æˆªå›¾æ•ˆæœã€‚</p>
            <ul>
                <li>æµ‹è¯•é¡¹ç›® 1</li>
                <li>æµ‹è¯•é¡¹ç›® 2</li>
                <li>æµ‹è¯•é¡¹ç›® 3</li>
            </ul>
        </div>
    </div>

    <script>
        function log(message) {
            const result = document.getElementById('test-output');
            const time = new Date().toLocaleTimeString();
            result.innerHTML += `<div><strong>[${time}]</strong> ${message}</div>`;
            result.scrollTop = result.scrollHeight;
            console.log('[TEST]', message);
        }

        function testMessage() {
            log('ğŸ”„ æµ‹è¯•æ¶ˆæ¯ä¼ é€’...');
            
            chrome.runtime.sendMessage({
                action: 'test'
            }, (response) => {
                if (chrome.runtime.lastError) {
                    log('âŒ æ¶ˆæ¯ä¼ é€’å¤±è´¥: ' + chrome.runtime.lastError.message);
                } else if (response && response.success) {
                    log('âœ… æ¶ˆæ¯ä¼ é€’æˆåŠŸ: ' + response.message);
                } else {
                    log('âŒ æ¶ˆæ¯ä¼ é€’å¼‚å¸¸: ' + JSON.stringify(response));
                }
            });
        }

        function testScreenshot() {
            log('ğŸ“¸ æµ‹è¯•æ™®é€šæˆªå›¾...');
            
            chrome.runtime.sendMessage({
                action: 'takeScreenshot',
                pageInfo: {
                    title: document.title,
                    url: window.location.href
                }
            }, (response) => {
                if (chrome.runtime.lastError) {
                    log('âŒ æ™®é€šæˆªå›¾å¤±è´¥: ' + chrome.runtime.lastError.message);
                } else if (response && response.success) {
                    log('âœ… æ™®é€šæˆªå›¾æˆåŠŸ');
                } else {
                    log('âŒ æ™®é€šæˆªå›¾å¼‚å¸¸: ' + JSON.stringify(response));
                }
            });
        }

        function testAreaScreenshot() {
            log('âœ‚ï¸ æµ‹è¯•åŒºåŸŸæˆªå›¾...');
            
            const selection = {
                x: 100,
                y: 100,
                width: 300,
                height: 200,
                devicePixelRatio: window.devicePixelRatio || 1
            };
            
            chrome.runtime.sendMessage({
                action: 'takeAreaScreenshot',
                selection: selection,
                actionType: 'save',
                pageInfo: {
                    title: document.title,
                    url: window.location.href
                }
            }, (response) => {
                if (chrome.runtime.lastError) {
                    log('âŒ åŒºåŸŸæˆªå›¾å¤±è´¥: ' + chrome.runtime.lastError.message);
                } else if (response && response.success) {
                    log('âœ… åŒºåŸŸæˆªå›¾æˆåŠŸ');
                } else {
                    log('âŒ åŒºåŸŸæˆªå›¾å¼‚å¸¸: ' + JSON.stringify(response));
                }
            });
        }

        function triggerAreaSelection() {
            log('âœ‚ï¸ è§¦å‘åŒºåŸŸé€‰æ‹©æ¨¡å¼...');
            
            chrome.runtime.sendMessage({
                action: 'startAreaSelection'
            }, (response) => {
                if (chrome.runtime.lastError) {
                    log('âŒ è§¦å‘åŒºåŸŸé€‰æ‹©å¤±è´¥: ' + chrome.runtime.lastError.message);
                } else if (response && response.success) {
                    log('âœ… åŒºåŸŸé€‰æ‹©æ¨¡å¼å·²å¯åŠ¨ï¼Œè¯·åœ¨é¡µé¢ä¸Šé€‰æ‹©åŒºåŸŸ');
                } else {
                    log('âŒ è§¦å‘åŒºåŸŸé€‰æ‹©å¼‚å¸¸: ' + JSON.stringify(response));
                }
            });
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ˜¾ç¤ºåˆå§‹ä¿¡æ¯
        window.addEventListener('load', () => {
            log('ğŸ“„ æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
        });
    </script>
</body>
</html>